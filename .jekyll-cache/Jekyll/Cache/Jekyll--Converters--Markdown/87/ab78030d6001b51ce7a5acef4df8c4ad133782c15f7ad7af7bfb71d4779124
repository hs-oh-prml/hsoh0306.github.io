I"C<p>ê°•ì˜ìë£Œì— ì¬ë°Œì–´ ë³´ì´ëŠ” ë‚´ìš©ì´ ìˆì–´ì„œ ë”°ë¡œ í¬ìŠ¤íŒ…í•œë‹¤. ì‚¬ëŒì˜ í”¼ë¶€ìƒ‰ì€ ì¸ì¢…ì— ìƒê´€ ì—†ì´ ì¼ì •í•œ ë²”ìœ„ ë‚´ì— ê°’ì„ ê°€ì ¸ì„œ ìƒ‰ì„ ì´ìš©í•˜ì—¬ í”¼ë¶€ìƒ‰ì„ ê²€ì¶œ í•  ìˆ˜ ìˆë‹¤ê³  í•œë‹¤. â€œHuman Skin Detection Using RGB, HSV and YCbCr Color Modelsâ€ëŠ” ìƒ‰ì„ ì´ìš©í•˜ì—¬ ì‚¬ëŒì˜ í”¼ë¶€ë¥¼ ê²€ì¶œí•˜ëŠ” ê²ƒì„ ì—°êµ¬í•œ ë…¼ë¬¸ì´ë‹¤. ê¸°ê³„í•™ìŠµì„ ì´ìš©í•˜ì§€ ì•Šê³  thresholdë¥¼ ì´ìš©í•œ ë°©ë²•ìœ¼ë¡œ, ì—¬ëŸ¬ color spaceë¥¼ ì¡°í•©í•œ ë°©ë²•ì„ ì œì‹œí–ˆë‹¤. êµ¬í˜„í•˜ê¸° ì „ì— Color spaceì— ëŒ€í•´ ê°„ëµí•˜ê²Œ ì•Œì•„ë³´ì.</p>

<h4 id="red-green-and-blue-rgb-color-model">Red, Green, and Blue (RGB) Color Model</h4>

<p>RGBëŠ” ê°€ì¥ ë„ë¦¬ ì‚¬ìš©ë˜ê³  ìˆëŠ” color modelì´ë‹¤. ëª¨ë“  ìƒ‰ì„ ë¹¨ê°•(R), ì´ˆë¡(G), íŒŒë‘(B)ì˜ í•©ìœ¼ë¡œ í‘œí˜„í•˜ë©°, ë””ì§€í„¸ ì´ë¯¸ì§€ì˜ ì €ì¥ì— ì‚¬ìš©ëœë‹¤. ë³´í†µ í•˜ë‚˜ì˜ colorë‹¹ 8-bitë¥¼ í• ë‹¹í•˜ë©°, [0, 255] ì‚¬ì´ ê°’ì„ ê°€ì§„ë‹¤. normalized RGBëŠ” ì´ë¥¼ [0, 1]ë¡œ ì •ê·œí™”í•œ í‘œí˜„ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì´ ì“°ë©´ ëœë‹¤.</p>

\[\begin{aligned}
r = {R \over R + G + B} \\
g = {G \over R + G + B} \\
b = {B \over R + G + B}
\end{aligned}\]

<center>
<img src="/assets/img/rgb_model.jpg" />
</center>

<h4 id="ycbcr-luminance-chrominance-color-model">YCbCr (Luminance, Chrominance) Color Model</h4>
<p>YCbCrì€ encoded non-linear RGBë¼ê³  í•œë‹¤. ì••ì¶•í•  ë•Œ ë§ì´ ì¨ì„œ, TV ì†¡ì‹ , ë¹„ë””ì˜¤,  JPEG, MPEG1, MPEG2, MPEG4 ë“±ì— ì‚¬ìš©ëœë‹¤. YCbCrì—ì„œ YëŠ” luminance, CbëŠ” blueê°’ê³¼ ê¸°ì¤€ ê°’(Y)ì˜ ì°¨ì´,  Crì€ redê°’ê³¼ ê¸°ì¤€ ê°’(Y)ì˜ ì°¨ì´ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤.</p>

\[\begin{aligned}
Y = 0.299R + 0.287G + 0.11B 
Cr = R - Y 
Cb = B - Y
\end{aligned}\]

<center>
<img src="/assets/img/ycbcr_model.jpg" />
</center>

<h4 id="hue-saturation-value-hsv-color-model">Hue Saturation Value (HSV) Color Model</h4>

<p>HSVëŠ” RGBë³´ë‹¤ ì‚¬ëŒì´ ê²½í—˜í•˜ëŠ” ìƒ‰ì„ ë” ì§ê´€ì ìœ¼ë¡œ ë‚˜íƒ€ë‚´ëŠ” modelì´ë‹¤. HSVì—ì„œ H(Hue)ëŠ” [0, 1.0] ë²”ìœ„ë¥¼ ê°€ì§€ë©° red, yellow, green, cyan, blue, magenta ê·¸ë¦¬ê³  ë‹¤ì‹œ redë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. S(Saturation)ëŠ” [0, 1.0]ì— ê°’ì„ ê°€ì§€ë©´ ìƒ‰ì´ ì–¼ë§ˆë‚˜ saturateí•œì§€(0: gray, 1.0: no white componet)ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤.  V(Value)ëŠ” ë°ê¸° ê°’ì„ ì˜ë¯¸í•˜ë©° [0, 1.0]ì˜ ê°’ì„ ê°€ì§„ë‹¤. Hë¥¼ ê°ë„ë¡œ í‘œí˜„í•˜ì—¬ [0, 360]ë„ë¡œ í‘œí˜„í•˜ëŠ” ë°©ë²•ë„ ìˆë‹¤. opencvì—ì„œëŠ” HSVì€ ê°ê° H: [0, 180], S: [0, 255], V: [0, 255]ë¡œ í‘œí˜„ëœë‹¤.</p>

<center>
<img src="/assets/img/hsv_model.jpg" />
</center>

<h3 id="proposed-skin-detection-algorithm">Proposed Skin Detection Algorithm</h3>
<p>ë…¼ë¬¸ì—ì„œëŠ” skin color detectionì„ ìœ„í•œ 2ê°€ì§€ ë°©ë²•ì„ ì œì‹œí–ˆë‹¤. í•˜ë‚˜ëŠ” ARGBì™€ HSVë¥¼ ì‚¬ìš©í•œ ë°©ë²•ì´ê³ , ë‹¤ë¥¸ í•˜ë‚˜ëŠ” ARGBì™€ YCbCrì„ ì´ìš©í•œ ë°©ë²•ì´ë‹¤. ARGBëŠ” RGB spaceì— íˆ¬ëª…ë„ A(alpha)ë¥¼ ì¶”ê°€í•œ modelì´ë‹¤.</p>

<pre>
<code>
ARGB&amp;HSV

if (0.0 &lt;= H &lt;= 50.0 &amp; 0.23 &lt;= S &lt;= 0.68 
    &amp; R &gt; 95 &amp; G &gt; 40 &amp; B &gt; 20 &amp; R &gt; G &amp; R &gt; B
    &amp; | R - G | &gt; 15 &amp; A &gt; 15){
    skin color
    }
else {
    non-skin color
}
</code>
</pre>

<pre>
<code>
ARGB&amp;YCbCr

if (R &gt; 95 &amp; G &gt; 40 &amp; B &gt; 20 &amp; R &gt; G &amp; R &gt; B
    &amp; | R - G | &gt; 15 &amp; A &gt; 15 &amp; Cr &gt; 135 &amp;
    Cb &gt; 85 &amp; Y &gt; 80 &amp; Cr &lt;= (1.5862*Cb)+20 &amp;
    Cr&gt;=(0.3448*Cb)+76.2069 &amp;
    Cr &gt;= (-4.5652*Cb)+234.5652 &amp;
    Cr &lt;= (-1.15*Cb)+301.75 &amp;
    Cr &lt;= (-2.2857*Cb)+432.85) {
    skin color
    }
else {
    non-skin color
}
</code>
</pre>
<blockquote>
  <p>(H : Hue ; S: Saturation ; R : Red ; B: Blue ; G : Green ; Cr, Cb : Chrominance components ; Y : luminance component )</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">imread</span><span class="p">(</span><span class="s">'face.jpg'</span><span class="p">)</span>

<span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">img</span><span class="p">.</span><span class="n">shape</span>

<span class="n">argb</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cv2</span><span class="p">.</span><span class="n">COLOR_BGR2RGBA</span><span class="p">)</span>        <span class="c1"># ARGB 
</span><span class="n">hsv</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cv2</span><span class="p">.</span><span class="n">COLOR_BGR2HSV</span><span class="p">)</span>          <span class="c1"># HSV
</span><span class="n">ycrcb</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cv2</span><span class="p">.</span><span class="n">COLOR_BGR2YCR_CB</span><span class="p">)</span>     <span class="c1"># YCrCb
</span>
<span class="n">norm_hsv</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="nb">float</span><span class="p">)</span>   
<span class="n">norm_hsv</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">hsv</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span>
<span class="n">norm_hsv</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">hsv</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">255</span>
<span class="n">norm_hsv</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">hsv</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">255</span>

<span class="n">res1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="n">uint8</span><span class="p">)</span>       <span class="c1"># ì²«ë²ˆì§¸ ë°©ë²• ê²°ê³¼
</span><span class="n">res2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="n">uint8</span><span class="p">)</span>       <span class="c1"># ë‘ë²ˆì§¸ ë°©ë²• ê²°ê³¼
</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">height</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">width</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">argb</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">argb</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">argb</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">argb</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

        <span class="n">h</span> <span class="o">=</span> <span class="n">norm_hsv</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">norm_hsv</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

        <span class="n">y</span> <span class="o">=</span> <span class="n">ycrcb</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">cr</span> <span class="o">=</span> <span class="n">ycrcb</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">cb</span> <span class="o">=</span> <span class="n">ycrcb</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>

        <span class="c1"># opencvì—ì„œ hsvì˜ ë²”ìœ„ëŠ” h: [0, 180], s: [0, 255], v: [0, 255]ì´ë‹¤.
</span>        <span class="c1"># ARGB
</span>        <span class="k">if</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="mi">95</span> <span class="ow">and</span> <span class="n">g</span> <span class="o">&gt;</span> <span class="mi">40</span> <span class="ow">and</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="mi">20</span> <span class="ow">and</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="n">g</span> <span class="ow">and</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="n">b</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">g</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">15</span> <span class="ow">and</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="mi">15</span><span class="p">:</span>
            <span class="c1"># HSV
</span>            <span class="k">if</span> <span class="n">h</span> <span class="o">&gt;=</span> <span class="mf">0.0</span> <span class="ow">and</span> <span class="n">h</span> <span class="o">&lt;=</span> <span class="mf">50.0</span> <span class="ow">and</span> <span class="n">s</span> <span class="o">&gt;=</span> <span class="mf">0.23</span> <span class="ow">and</span> <span class="n">s</span> <span class="o">&lt;=</span> <span class="mf">0.68</span><span class="p">:</span>
                <span class="n">res1</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span>
                <span class="n">res1</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">g</span>
                <span class="n">res1</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span>
            <span class="c1"># YCrCb
</span>            <span class="k">if</span> <span class="n">cb</span> <span class="o">&gt;</span> <span class="mi">85</span> <span class="ow">and</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="mi">80</span> <span class="ow">and</span> <span class="n">cr</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="mf">1.5862</span><span class="o">*</span><span class="n">cb</span><span class="p">)</span> <span class="o">+</span> <span class="mi">20</span> <span class="ow">and</span> <span class="n">cr</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mf">0.3448</span> <span class="o">*</span> <span class="n">cb</span><span class="p">)</span> <span class="o">+</span> <span class="mf">76.2069</span> <span class="ow">and</span> <span class="n">cr</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="o">-</span><span class="mf">4.5652</span> <span class="o">*</span> <span class="n">cb</span><span class="p">)</span> <span class="o">+</span> <span class="mf">234.5652</span> <span class="ow">and</span> <span class="n">cr</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.15</span> <span class="o">*</span><span class="n">cb</span><span class="p">)</span> <span class="o">+</span> <span class="mf">301.75</span> <span class="ow">and</span> <span class="n">cr</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="o">-</span><span class="mf">2.2857</span> <span class="o">*</span> <span class="n">cb</span><span class="p">)</span> <span class="o">+</span> <span class="mf">432.85</span><span class="p">:</span>
                <span class="n">res2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span>
                <span class="n">res2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">g</span>
                <span class="n">res2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span>


<span class="n">result</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">hconcat</span><span class="p">([</span><span class="n">img</span><span class="p">,</span> <span class="n">res1</span><span class="p">,</span> <span class="n">res2</span><span class="p">])</span>
<span class="n">cv2</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span><span class="s">'skin color detection'</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
<span class="n">cv2</span><span class="p">.</span><span class="n">imwrite</span><span class="p">(</span><span class="s">'skin_color.png'</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
<span class="n">cv2</span><span class="p">.</span><span class="n">waitKey</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">cv2</span><span class="p">.</span><span class="n">destroyAllWindows</span><span class="p">()</span>
</code></pre></div></div>

<center>
<img src="/assets/img/skin_color_1.jpg" />
</center>
<center>
<img src="/assets/img/skin_color_2.jpg" />
</center>
<center>
<img src="/assets/img/skin_color_3.jpg" />
</center>
<center>
<img src="/assets/img/skin_color_4.jpg" />
</center>

<blockquote>
  <p>ì™¼ìª½ë¶€í„° ì›ë³¸, ARGB&amp;HSV ë°©ë²•ì„ ì‚¬ìš©í•œ ê²°ê³¼, ARGB&amp;YCbCr ë°©ë²• ì‚¬ìš©í•œ ê²°ê³¼</p>
</blockquote>

<p>thresholdë§Œ ì‚¬ìš©í•œ ë°©ë²•ì´ë¼ ì¢€ ì• ë§¤í•  ê±° ê°™ì•˜ëŠ”ë° ìƒê°ë³´ë‹¤ ê½¤ ê´œì°®ì€ ê²°ê³¼ë¥¼ ë‚´ì—ˆë‹¤. ì¸ì¢…ì— í¬ê²Œ ìƒê´€ì´ ì—†ëŠ” ê±° ê°™ê³ , HSVë³´ë‹¤ YCbCrì„ ì‚¬ìš©í•œ ê²ƒì´ ê²°ê³¼ê°€ ë” ì˜ë‚˜ì˜¤ëŠ” ê±° ê°™ë‹¤.</p>

<h3 id="reference">Reference</h3>
<p><a href="https://arxiv.org/ftp/arxiv/papers/1708/1708.02694.pdf">S. Kolkur, D. Kalbande, P. Shimpi, C. Bapat, and J. Jatakia,â€™Human Skin Detection Using RGB, HSV and YCbCr Color Modelsâ€™, <em>ICCASP/ICMMD</em>, 2016, Vol. 137, pp.324-332</a></p>
:ET